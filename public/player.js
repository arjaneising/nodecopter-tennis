// Generated by CoffeeScript 1.4.0
(function() {
  var io, log, socket, turnClassName;

  io = window.io;

  turnClassName = "myTurn";

  log = function(t) {
    return document.body.innerHTML = t;
  };

  socket = io.connect("http://" + document.location.host);

  socket.on("news", function(data) {
    console.log(data);
    return socket.emit("my other event", {
      my: "data"
    });
  });

  socket.on("connect", function() {
    var bottomThreshold, checkInterval, done, draw, playing, reset, threshold, tick, zMax;
    playing = false;
    checkInterval = void 0;
    threshold = 5;
    zMax = 0;
    bottomThreshold = 1;
    done = function() {
      socket.emit("kick", {
        z: zMax
      });
      reset();
      playing = false;
      log("done");
      return document.body.classList.remove(turnClassName);
    };
    reset = function() {
      zMax = 0;
      return log("reset");
    };
    draw = function() {
      return log(zMax);
    };
    log("connected");
    tick = function(data) {
      var acc;
      if (!playing) {
        return;
      }
      acc = data.acceleration;
      if (acc.z > bottomThreshold) {
        zMax = Math.max(acc.z, zMax);
        draw();
      }
      if (acc.z < zMax && zMax > threshold) {
        return done();
      }
    };
    window.addEventListener("devicemotion", tick, false);
    socket.on("turn", function() {
      playing = true;
      document.body.classList.add(turnClassName);
      return log("Your turn now!");
    });
    return socket.emit("player");
  });

}).call(this);
